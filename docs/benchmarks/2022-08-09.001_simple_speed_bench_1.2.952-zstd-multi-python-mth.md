# Простые тесты скорости работы DedupSQLfs v1.2.952 за 09.08.2022

1. Проверка работы ФС на новой версии python.
2. Проверка работы в несколько потоков и процессов.
3. Потребление памяти.
4. Сравнение работы на версиях python.

Распаковка исходников LibreOffice 6.4.7, 7.1.8, 7.2.7, 7.3.5

Проверка работы на движке: sqlite 3.39.2

CPU: i5-6600K @ 3.50GHz
MEM: 2*16 DDR4 2133Mhz

System: Ubuntu 18.04 amd64

Kernel: 5.4.0-122-lowlatency

Python: 3.10.6, 3.11~b5

Размер LibreOffice в tar:

* 6.4.7 - 1133M
* 7.1.8 - 1184M
* 7.2.7 - 1204M
* 7.3.5 - 1215M

Другое: включен autocommit, выключен sync, hash=md5, режим=однопоточный

Команда:
```sh
/usr/bin/time -v python3.10 ./mount.dedupsqlfs -vv --verbose-stats --data $HOME/Temp/sqlfs/data/ --compress zstd:1 --no-sync --no-cache-flusher --minimal-compress-size -1 -o noatime $HOME/Temp/sqlfs/mount
```

Извлечение LO:
```sh
tar xf {libre-tar} -C $HOME/Temp/sqlfs/mount && sudo umount $HOME/Temp/sqlfs/mount
```

Извлечение происходило без стирания предыдущих копий libreoffice. Тестировалась в том числе и дедупликация.

Тестировался только метод ZSTD: zstd:1

## Тесты

| LO ver                  || 6.4.7                           ||| 7.1.8                           ||| 7.2.7                           ||| 7.3.5                           |||
|------------|:-----------:|:--------:|:----------:|:---------:|:--------:|:----------:|:---------:|:--------:|:----------:|:---------:|:--------:|:----------:|:---------:|
| **python** | **threads** | **time** | **memory** | **speed** | **time** | **memory** | **speed** | **time** | **memory** | **speed** | **time** | **memory** | **speed** |
| 3.11~b5    | single      | 1:38.39  | 403        | 39.81     | 1:33.71  | 390        | 44.06     | 1:25.61  | 285        | 57.07     | 1:20.09  | 297        | 48.25     |
| 3.10.6     | single      | 2:20.79  | 388        | 30.98     | 1:42.28  | 355        | 39.76     | 1:35.24  | 380        | 44.77     | 1:34.99  | 383        | 40.40     |

* :time   - время работы dedupsqlfs, в том числе и umount
* :memory - размер в памяти, согласно отладке в time, max resident size MiB
* :speed  - показатели отладки dedupsqlfs по скорости записи данных, MiB/s

## Результат

Просто посмотреть и сравнить обновление версии python. И сколько памяти тратится.
- похоже, что python-3.11 работает быстрее предыдущих версий
- нужно проверить и много-поточно-процессные режимы
