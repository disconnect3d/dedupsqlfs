# Простые тесты скорости работы DedupSQLfs v1.2.952 с разными методами сжатия

Распаковка LibreOffice 6.4.7, 7.1.8, 7.2.7, 7.3.3

Проверка работы на движке: sqlite 3.38.2

CPU: i5-6600K @ 3.50GHz

System: Ubuntu 18.04 amd64

Kernel: 5.4.0-104-lowlatency

Python: 3.7.13

Размер LibreOffice в tar:

* 6.4.7 - 1133M
* 7.1.8 - 1184M
* 7.2.7 - 1204M
* 7.3.3 - 1213M

Другое: включен autocommit, выключен sync, hash=md5, режим=однопоточный

Команда:
```sh
/usr/bin/time -v python3.7 ./mount.dedupsqlfs -vv --verbose-stats --data $HOME/Temp/sqlfs/data/ --compress {method} --no-sync --no-cache-flusher --minimal-compress-size -1 -o noatime $HOME/Temp/sqlfs/mount
```

Извлечение LO:
```sh
tar xf {libre-tar} -C $HOME/Temp/sqlfs/mount && sudo umount $HOME/Temp/sqlfs/mount
```

Извлечение происходило без стирания предыдущих копий libreoffice. Тестировалась в том числе и дедупликация.

Тестировались только быстрые методы:

* none
* zlib:1
* zstd:1
* brotli:0
* lz4

## Тесты

| LO ver   || 6.4.7             ||| 7.1.8             ||| 7.2.7             ||| 7.3.3             ||
|----------|:----:|:----:|:-----:|:----:|:----:|:-----:|:----:|-----:|:-----:|:----:|:----:|:-----:|
| **method** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** |
| none     | 1:49.09 | 1095M | 31.16 | 1:39.89 | 1645M | 38.68 | 1:36.97 | 2075M | 42.55 | 1:39.26 | 2476M | 40.27 |
| zlib:1   | 1:57.39 | 433M | 28.48 | 1:48.13 | 631M | 33.00 | 1:42.28 | 777M | 37.25 | 1:41.37 | 909M | 32.88 |
| zstd:1   | 1:47.90 | 419M | 30.39 | 1:46.63 | 608M | 33.90 | 1:50.39 | 745M | 41.24 | 1:46.63 | 869M | 43.86 |
| brotli:0 | 1:48.79 | 448M | 29.10 | 1:40.48 | 654M | 33.90 | 1:41.72 | 803M | 37.92 | 1:37.96 | 938M | 39.85 |
| lz4      | 1:43.04 | 516M | 27.49 | 1:40.96 | 765M | 35.17 | 1:35.83 | 947M | 43.32 | 1:38.39 | 1087M | 40.46 |

Для сравнения: однопоточные для python-3.4
| LO ver   || 6.4.7 ||| 7.1.8 ||| 7.2.7 ||| 7.3.3 ||
|----------|:----:|:----:|:-----:|:----:|:----:|:-----:|:----:|-----:|:-----:|:----:|:----:|:-----:|
| **method** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** |
| none     | 1:56.79 | 1095M | 27.98 | 1:59.22 | 1646M | 30.73 | 1:54.59 | 2076M | 40.14 | 1:51.22 | 2477M | 35.29 |
| zlib:1   | 2:09.04 | 433M | 17.82 | 2:05.55 | 632M | 30.13 | 1:56.98 | 778M | 29.01 | 1:56.24 | 910M | 33.87 |
| zstd:1   | 1:58.26 | 420M | 23.95 | 1:53.89 | 609M | 32.20 | 1:50.66 | 746M | 32.24 | 1:51.19 | 869M | 32.10 |
| brotli:0 | 2:03.32 | 448M | 23.01 | 1:58.40 | 654M | 30.37 | 1:52.02 | 804M | 37.62 | 1:54.36 | 939M | 36.82 |
| lz4      | 2:01.26 | 516M | 24.13 | 1:53.36 | 765M | 28.65 | 1:52.24 | 947M | 33.45 | 1:51.48 | 1087M | 37.03 |

* :time  - время работы dedupsqlfs, в том числе и umount
* :size  - размер итоговых данных в ~/Temp/sqlfs/data/, MiB
* :speed - показатели отладки dedupsqlfs по скорости записи данных, MiB/s

## Результат

Просто посмотреть и сравнить.

- похоже, что python-3.7 работает быстрее 3.4
- надо будет сравнить остальные версии python 3.8-3.10, оставив только сжатие none, zstd