# Простые тесты скорости работы DedupSQLfs v1.2.952 с разными методами сжатия

Распаковка LibreOffice 6.4.7, 7.1.8, 7.2.7, 7.3.3

Проверка работы на движке: sqlite 3.38.2

CPU: i5-6600K @ 3.50GHz

System: Ubuntu 18.04 amd64

Kernel: 5.4.0-104-lowlatency

Python: 3.10.4

Размер LibreOffice в tar:

* 6.4.7 - 1133M
* 7.1.8 - 1184M
* 7.2.7 - 1204M
* 7.3.3 - 1213M

Другое: включен autocommit, выключен sync, hash=md5, режим=однопоточный

Команда:
```sh
/usr/bin/time -v python3.10 ./mount.dedupsqlfs -vv --verbose-stats --data $HOME/Temp/sqlfs/data/ --compress {method} --no-sync --no-cache-flusher --minimal-compress-size -1 -o noatime $HOME/Temp/sqlfs/mount
```

Извлечение LO:
```sh
tar xf {libre-tar} -C $HOME/Temp/sqlfs/mount && sudo umount $HOME/Temp/sqlfs/mount
```

Извлечение происходило без стирания предыдущих копий libreoffice. Тестировалась в том числе и дедупликация.

Тестировались только быстрые методы:

* none
* zstd:1

## Тесты

| LO ver   || 6.4.7 ||| 7.1.8 ||| 7.2.7 ||| 7.3.3 ||
|----------|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|
| **method** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** |
| none     | 1:42.80 | 1095M | 32.16 | 1:38.80 | 1645M | 36.98 | 1:37.99 | 2075M | 39.06 | 1:35.77 | 2476M | 46.07 |
| zstd:1   | 1:42.23 | 419M | 31.65 | 1:41.06 | 608M | 36.83 | 1:35.57 | 745M | 43.44 | 1:32.53 | 869M | 40.70 |

Для сравнения: однопоточные для python-3.9
| LO ver   || 6.4.7 ||| 7.1.8 ||| 7.2.7 ||| 7.3.3 ||
|----------|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|
| **method** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** |
| none     | 1:49.55 | 1095M | 26.82 | 1:40.20 | 1645M | 33.29 | 1:39.13 | 2075M | 41.87 | 1:38.90 | 2476M | 39.48 |
| zstd:1   | 1:46.48 | 419M | 30.43 | 1:42.05 | 608M | 33.44 | 1:54.69 | 745M | 41.63 | 1:36.38 | 869M | 45.76 |

Для сравнения: однопоточные для python-3.8
| LO ver   || 6.4.7 ||| 7.1.8 ||| 7.2.7 ||| 7.3.3 ||
|----------|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|
| **method** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** |
| none     | 1:42.54 | 1095 | 31.71 | 1:40.33 | 1645M | 33.37 | 1:34.12 | 2075M | 41.10 | 1:33.53 | 2476M | 40.83 |
| zstd:1   | 1:45.87 | 419M | 29.53 | 1:37.70 | 608M | 34.35 | 1:35.68 | 745M | 45.56 | 1:37.59 | 869M | 38.58 |

Для сравнения: однопоточные для python-3.7
| LO ver   || 6.4.7 ||| 7.1.8 ||| 7.2.7 ||| 7.3.3 ||
|----------|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|
| **method** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** |
| none     | 1:49.09 | 1095M | 31.16 | 1:39.89 | 1645M | 38.68 | 1:36.97 | 2075M | 42.55 | 1:39.26 | 2476M | 40.27 |
| zstd:1   | 1:47.90 | 419M | 30.39 | 1:46.63 | 608M | 33.90 | 1:50.39 | 745M | 41.24 | 1:46.63 | 869M | 43.86 |

Для сравнения: однопоточные для python-3.4
| LO ver   || 6.4.7 ||| 7.1.8 ||| 7.2.7 ||| 7.3.3 ||
|----------|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|:----:|
| **method** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** | **time** | **size** | **speed** |
| none     | 1:56.79 | 1095M | 27.98 | 1:59.22 | 1646M | 30.73 | 1:54.59 | 2076M | 40.14 | 1:51.22 | 2477M | 35.29 |
| zstd:1   | 1:58.26 | 420M | 23.95 | 1:53.89 | 609M | 32.20 | 1:50.66 | 746M | 32.24 | 1:51.19 | 869M | 32.10 |

* :time  - время работы dedupsqlfs, в том числе и umount
* :size  - размер итоговых данных в ~/Temp/sqlfs/data/, MiB
* :speed - показатели отладки dedupsqlfs по скорости записи данных, MiB/s

## Результат

Просто посмотреть и сравнить.

- похоже что python 3.10 восстановил скорость до уровня 3.8
