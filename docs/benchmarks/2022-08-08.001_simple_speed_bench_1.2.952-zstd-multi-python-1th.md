# Простые тесты скорости работы DedupSQLfs v1.2.952 за 08.08.2022

1. Проверка работы ФС на новой версии python.
3. Потребление памяти.
4. Сравнение работы на версиях python.

Распаковка исходников LibreOffice 6.4.7, 7.1.8, 7.2.7, 7.3.5

Проверка работы на движке: sqlite 3.39.2

CPU: i5-6600K @ 3.50GHz
MEM: 2*16 DDR4 2133Mhz

System: Ubuntu 18.04 amd64

Kernel: 5.4.0-122-lowlatency

Python: 3.10.6, 3.11~b5, 3.9.13, 3.8.13, 3.7.13, 3.6.15

Размер LibreOffice в tar:

* 6.4.7 - 1133M
* 7.1.8 - 1184M
* 7.2.7 - 1204M
* 7.3.5 - 1215M

Другое: включен autocommit, выключен sync, hash=md5, режим=однопоточный

Команда:
```sh
/usr/bin/time -v python3.10 ./mount.dedupsqlfs -vv --verbose-stats --data $HOME/Temp/sqlfs/data/ --compress zstd:1 --no-sync --no-cache-flusher --minimal-compress-size -1 -o noatime $HOME/Temp/sqlfs/mount
```

Извлечение LO:
```sh
tar xf {libre-tar} -C $HOME/Temp/sqlfs/mount && sudo umount $HOME/Temp/sqlfs/mount
```

Извлечение происходило без стирания предыдущих копий libreoffice. Тестировалась в том числе и дедупликация.

Тестировался только метод ZSTD: zstd:1

## Тесты

| LO ver                  || 6.4.7                           ||| 7.1.8                           ||| 7.2.7                           ||| 7.3.5                           |||
|------------|:-----------:|:--------:|:----------:|:---------:|:--------:|:----------:|:---------:|:--------:|:----------:|:---------:|:--------:|:----------:|:---------:|
| **python** | **threads** | **time** | **memory** | **speed** | **time** | **memory** | **speed** | **time** | **memory** | **speed** | **time** | **memory** | **speed** |
| 3.11~b5    | single      | 1:38.39  | 403        | 39.81     | 1:33.71  | 390        | 44.06     | 1:25.61  | 285        | 57.07     | 1:20.09  | 297        | 48.25     |
| 3.10.6     | single      | 2:20.79  | 388        | 30.98     | 1:42.28  | 355        | 39.76     | 1:35.24  | 380        | 44.77     | 1:34.99  | 383        | 40.40     |
| 3.9.13     | single      | 1:51.21  | 380        | 28.60     | 1:37.97  | 292        | 37.26     | 1:32.54  | 294        | 39.08     | 1:33.36  | 294        | 45.33     |
| 3.8.13     | single      | 1:42.29  | 384        | 28.43     | 1:39.21  | 270        | 35.14     | 1:32.81  | 414        | 37.70     | 1:29.59  | 295        | 44.84     |
| 3.7.13     | single      | 1:46.27  | 380        | 30.93     | 1:33.95  | 288        | 36.35     | 1:31.36  | 290        | 43.23     | 1:28.66  | 295        | 47.19     |
| 3.6.15     | single      | 1:49.43  | 371        | 32.92     | 1:38.17  | 287        | 31.62     | 1:33.36  | 398        | 38.14     | 1:33.42  | 393        | 38.20     |

* :time   - время работы dedupsqlfs, в том числе и umount
* :memory - размер в памяти, согласно отладке в time, max resident size MiB
* :speed  - показатели отладки dedupsqlfs по скорости записи данных, MiB/s

## Результат

Просто посмотреть и сравнить обновление версии python. И сколько памяти тратится.
- похоже, что python-3.11 работает быстрее предыдущих версий
- нужно проверить и много-поточно-процессные режимы
